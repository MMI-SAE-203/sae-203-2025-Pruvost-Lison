---
import Welcome from "../../components/Welcome.astro";
import LayoutWithHero from "../../layouts/LayoutWithHero.astro";
import image from "../../assets/img/2024_actu_festi_ap_05_ecran.jpg.webp";
import { getAllFilms } from "../../../backend/backend.mjs";

const title = "Programme des films";
const subTitle = "du Lundi 7 au jeudi 10 Juillet 2025.";
const description = ".";

// R√©cup√©rer les films depuis PocketBase
const events = await getAllFilms();
---

<LayoutWithHero title={title} description={description} subTitle={subTitle} src={image} alt="Image de cin√©ma">
    <div class="absolute inset-0 z-0 flex items-center justify-end overflow-hidden stroke-[--color-pink] stroke-24 opacity-80 mix-blend-difference" slot="patterns">
    </div>

    <Fragment slot="content">
        <h2>Programmation des films de la semaine</h2>

        <!-- Affichage des films -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 my-24">
            {events.length > 0 ? (
                events.map(event => (
                    <div class="p-4 bg-gray-100 rounded-lg shadow-lg overflow-hidden">
                        <!-- Affiche du film -->
                        <img 
                            src={event.affiche_film || "/default-image.jpg"} 
                            alt={`Affiche du film ${event.titre_film}`} 
                            class="w-full h-48 object-cover rounded-lg mb-4" 
                        />
                        
                        <!-- Titre du film -->
                        <h3 class="text-lg font-bold text-[color:var(--color-brownblack)]">
                            {event.titre_film}
                        </h3>
                        
                        <!-- Lieu et date du film -->
                        <p class="text-sm text-gray-600">
                            üìç {event.lieu_film} ‚Äî üìÖ {event.date_heure_film}
                        </p>
                    </div>
                ))
            ) : (
                <p class="col-span-full text-center">
                    Aucun film √† afficher.
                </p>
            )}
        </div>
    </Fragment>
</LayoutWithHero>
